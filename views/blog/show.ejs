<% include ../partials/header %>

<div class="ui container">
    <!-- Blog post -->
    <div class="ui placeholder segment">
        <h1 class="ui center aligned icon header"><%= post.header %></h1>
        <h3>Автор: <%= post.author %></h3>
        <div class="ui form">
            <div class="fields">
                <div class="field">
                    <form action="/blog/<%= post._id %>/edit" method="GET">
                        <button class="ui vertical animated mini yellow button">
                            <div class="visible content">Редактировать</div>
                            <div class="hidden content"><i class="icon edit"></i></div>
                        </button>
                    </form>
                </div>
                <div class="field">
                    <form action="/blog/<%= post._id %>?_method=DELETE" method="POST"> 
                        <button class="ui vertical animated mini red button">
                            <div class="visible content">Удалить</div>
                           <div class="hidden content"><i class="icon trash alternate"></i></div>
                        </button>
                    </form>
                </div>
            </div>
        </div>
        <p><%= post.description %></p>
        <p><strong><%= moment(post.date).locale("ru").fromNow() %></strong></p>
        <div class="backbutton">
            <a class="ui vertical animated blue button" href="/blog">
                <div class="visible content">Назад</div>
                <div class="hidden content"><i class="icon undo"></i></div>
            </a>
        </div>
    </div>
    <!-- end Blog post -->
    <!-- Blog post comments -->
    <a class="ui vertical animated right floated green button" href="/blog/<%= post._id %>/comments/new">
        <div class="visible content">Добавить комментарий</div>
        <div class="hidden content"><i class="icon edit"></i></div>
    </a>
    <div class="ui hidden divider"></div>
    <div class="ui comments">
        <h3 class="ui dividing header">Комментарии</h3>
        <% post.comments.sort(myFunctions.sortDescDate) %>
        <% post.comments.forEach(function(comment){ %>
        <div class="comment">
            <div class="content">
                <span class="author"><%= comment.author %></span>
                <div class="metadata">
                    <span class="date"><%= moment(comment.date).locale("ru").fromNow() %></span>
                </div>
                <div class="text">
                    <%= comment.description %>
                </div>
                <div class="ui form">
                    <div class="fields">
                        <div class="field">
                            <form action="/blog/<%= post._id %>/comments/<%= comment._id %>/edit" method="GET">
                                <button class="ui vertical animated mini yellow basic button">
                                    <div class="visible content">Редактировать</div>
                                    <div class="hidden content"><i class="icon edit"></i></div>
                                </button>
                            </form>
                        </div>
                        <div class="field">
                            <form action="/blog/<%= post._id %>/comments/<%= comment._id %>?_method=DELETE" method="POST">
                                <button class="ui vertical animated mini red basic button">
                                    <div class="visible content">Удалить</div>
                                    <div class="hidden content"><i class="icon trash alternate"></i></div>
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <% }); %>
    </div>
    <!-- end Blog post comments -->
</div>

<% include ../partials/footer %>